<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dockerize Go | mbielsk&#39;s notes</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Dockerize Go</span></h1>

<h2 class="date">2019/10/11</h2>
</div>

<main>
<p>#Go #Docker</p>

<p>Just a quick note on how to dockerize a simple statelss webapp written in go.
It is a two stage build to make the final image as compact as possible. At the moment for my app the final image has size of about 10mb, before optimization it was about 1gb!</p>

<pre><code>FROM golang:1.13-alpine as builder

RUN apk add --no-cache --virtual .build-deps \
    bash \
    gcc \
    git \
    musl-dev

RUN mkdir build
COPY . /build
WORKDIR /build

RUN go get
RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -ldflags '-extldflags &quot;-static&quot;' -o goapp .
RUN adduser -S -D -H -h /build goapp
USER goapp

FROM scratch
COPY --from=builder /build/goapp /app/
WORKDIR /app
EXPOSE 7778
CMD [&quot;./goapp&quot;]
</code></pre>

</main>

  <footer>
  
  
  </footer>
  </body>
</html>

